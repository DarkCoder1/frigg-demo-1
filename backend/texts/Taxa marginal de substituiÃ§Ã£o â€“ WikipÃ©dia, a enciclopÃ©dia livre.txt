Em microeconomia, a taxa marginal de substituição do bem A pelo bem B, representado por TMgS (B,A), mede a taxa à qual o consumidor está propenso a substituir o bem A pelo bem B [1] . Em outras palavras, esta taxa mede uma troca: o número de unidades do bem B (adquiridas) por unidade do bem A (sacrificada), desde que a troca busca mantenha o mesmo nível de satisfação (utilidade) do consumidor.
Esse nível de satisfação é representado matematicamente por uma utilidade, cuja imagem gráfica é chamada de mapa de curvas de indiferença. Cada ponto pertencentes a uma mesma curva de indeferença representa uma cesta composta por diferentes quantidades dos bens A e B, porém todas as cestas de uma mesma curva de indiferença apresentam a mesma utilidade para o consumidor. Entretanto, a cada ponto da curva (cada cesta) corresponde uma distinta taxa marginal de substituição.
A TMgS referente a uma cesta é dada pelo valor da derivada no ponto da curva de indiferença que representa a aludida cesta de bens (inclinação da reta tangente à curva naquele ponto). Dessa forma, a TMgS possui valor diferente para cada cesta representada pela curva, exceto em curvas de indiferença de bens substitutos ou complementares perfeitos, onde a TMgS é (localmente) constante.
A taxa marginal de substituição depende da quantidade de cada bem que o consumidor possui no momento. Por princípio intuitivo, afirma-se que cada nova unidade de um determinado bem possui menos utilidade do que a unidade imediatamente anterior. Para compreender esse conceito, basta imaginar alguém "matando a sede": o primeiro copo d'água possui maior utilidade (satisfação) do que o segundo, este maior do que o terceiro, e assim por diante. Isso mostra que a utilidade de um bem é decrescente.


Represente a função de utilidade como , onde U é a função de utilidade, x e y são bens. Adicionalmente:
Ao tomarmos a Diferencial total da função de utilidade, obtém-se:
Considerando a Derivada total da função de utilidade com respeito ao bem x,
Em qualquer ponto da curva de indiferença temos dU/dx = 0, porque U = c, onde c é uma constante. Então:
A taxa marginal de substituição é definida como menos a inclinação da curva de indiferença para qualquer cesta de bens que se considere (lado esquerdo da equação acima). Dessa maneira, ela se torna igual à razão entre as utilidades marginais de x e y:
Quando os consumidores maximizam utilidade sujeitos a uma restrição orçamentária, a curva de indiferença é tangente à reta orçamentária, que representa as cestas de bens que custam exatamente a renda do consumidor, ou seja, considerando a renda m e os preços  e :
Mas a TMgS tangencia a reta orçamentária, possuindo a mesma inclinação dela nesse ponto: , ou seja, . Dessa forma, quando o consumidor escolhe a cesta que maximiza sua utilidade, dentro de sua restrição orçamentária,
Este resultado importante nos diz que o consumidor maximiza utilidade ao alocar os recursos orçamentários de tal maneira que mantenha a mesma razão entre a utilidade marginal e preços para todos os bens. A intuição econômica por trás desse resultado é que o consumidor maximiza utilidade ao igualar: i) a razão de troca dada pelo mercado, , que informa o custo de oportunidade da aquisição de uma unidade de x em termos de  unidades do bem y; e ii) a razão entre as utilidades marginais de x e y, que é a taxa marginal de substituição, a quantidade que o consumidor abre mão no consumo de y para consumir mais de x, permanecendo com o mesmo nível de satisfação, ou seja, permanecendo na mesma curva de indiferença.
Quando as taxas marginais de substituição entre o bem x e o bem y forem diferentes para dois consumidores (consumidor  e consumidor ), isso significa que o consumidor "i" confere maior valor a um bem, enquanto o indivíduo "j" confere maior valor a outro. Nessa situação, há espaço para uma troca mutuamente benéfica (ou seja, uma melhora de Pareto)[3] .
O equilíbrio econômico é atingido quando a taxa marginal de substituição entre cada par de bens é igual para todos os consumidores. Matematicamente, portanto, teremos[3] :
A taxa marginal de substituiçaõ técnica é a taxa analoga a TMgS para o lado da oferta, em um mercado. Essa taxa representa o que uma empresa pode substituir de um fator produtivo por outro, mantendo o mesmo nível de produção. Num mapa de curvas isoquantas a Taxa Marginal de Substituição Técnica, é dada, assim como a TMgS, pela inclinação da curva que passa no ponto que representa da referida combinação de fatores de produção.